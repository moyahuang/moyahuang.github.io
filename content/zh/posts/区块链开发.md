---
title: "åŒºå—é“¾å¼€å‘"
date: 2020-12-13T18:06:20+08:00
draft: false
hideToc: true
enableToc: true
enableTocContent: false
author: Moya
authorEmoji: ğŸ™€
tags:
- å­¦æœ¯
- åŒºå—é“¾
- æ™ºèƒ½åˆçº¦
---
## Intro
- *Solidity*
> Solidity æ˜¯ä¸€é—¨é¢å‘åˆçº¦çš„ã€ä¸ºå®ç°æ™ºèƒ½åˆçº¦è€Œåˆ›å»ºçš„é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚è¿™é—¨è¯­è¨€å—åˆ°äº† C++ï¼ŒPython å’Œ Javascript è¯­è¨€çš„å½±å“ï¼Œè®¾è®¡çš„ç›®çš„æ˜¯èƒ½åœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰ä¸Šè¿è¡Œã€‚
- *Remix*
> åŸºäºæµè§ˆå™¨çš„ IDEï¼Œé›†æˆäº†ç¼–è¯‘å™¨å’Œ Solidity è¿è¡Œæ—¶ç¯å¢ƒï¼Œä¸éœ€è¦æœåŠ¡ç«¯ç»„ä»¶ã€‚
*MetaMask*
> MetaMaskæ˜¯é€šè¿‡æµè§ˆå™¨è®¿é—®åˆ†å¸ƒå¼åº”ç”¨ï¼ˆdappsï¼‰çš„ä¸€ä¸ªChromeæ’ä»¶ã€‚å¯è®¿é—®ä»¥å¤ªåŠä¸»ç½‘ï¼Œä»»ä¸€ä»¥å¤ªåŠæµ‹è¯•ç½‘ï¼ˆRopsten, Kovan, and Rinkebyï¼‰ï¼Œæˆ–è€…æœ¬åœ°åŒºå—é“¾ã€‚
- *Geth*
> Gethæ˜¯Go Ethereumçš„ç¼©å†™ï¼Œæ˜¯ä»¥å¤ªåŠåè®®çš„ä¸‰å¤§åŸå§‹å®ç°ä¹‹ä¸€ï¼ˆå¦å¤–è¿˜æœ‰C++å’ŒPythonï¼‰ï¼Œä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„å®¢æˆ·ç«¯å®ç°ã€‚å®ƒå¯ä»¥ä½œä¸ºå®¢æˆ·ç«¯è¿è¡Œåœ¨å‡ ä¹ä»»ä¸€æ“ä½œç³»ç»Ÿä¸Šã€‚å®‰è£…äº†å®¢æˆ·ç«¯çš„èŠ‚ç‚¹å¯ä»¥ä¸å…¶ä»–èŠ‚ç‚¹å»ºç«‹p2pé€šä¿¡ä¿¡é“ï¼Œç­¾ç½²å’Œå¹¿æ’­äº¤æ˜“ï¼ŒæŒ–æ˜ï¼Œéƒ¨ç½²å’Œä¸æ™ºèƒ½åˆçº¦äº¤äº’ã€‚
> å¯åŠ¨Gethæ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨ç«¯å£8545å¯åŠ¨RPCæœåŠ¡å™¨ã€‚ç„¶åä½¿ç”¨web3jç­‰åº“è¿æ¥åˆ°localhostï¼š8545æˆ–ä½¿ç”¨curlæˆ–wgetæ‰‹åŠ¨è°ƒç”¨å®ƒæ¥è®¿é—®æ­¤ç«¯å£çš„RPCæœåŠ¡å™¨åŠå…¶æ–¹æ³•ã€‚
## ç®€å•çš„æ™ºèƒ½åˆçº¦
1. Solidityç¬¬ä¸€è¡Œä½¿ç”¨å…³é”®è¯`pragma`æŒ‡å®šä½¿ç”¨å“ªä¸ªç‰ˆæœ¬ç¼–è¯‘å™¨å¤„ç†æºä»£ç ã€‚
2. `event`äº‹ä»¶ç±»å‹å¯ä»¥è®©ç›‘å¬è¯¥äº‹ä»¶çš„listeneræ”¶åˆ°é€šçŸ¥ï¼Œæ–¹ä¾¿äº‹åŠ¡è¿½è¸ªã€‚
ä¸‹é¢è¿™ä¸ªç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶ï¼Œæ”¾åœ¨éœ€è¦ç›‘å¬çš„å‡½æ•°æœ€åæ‰§è¡Œï¼š
```solidity
event Sent(address from, address to, uint amount);
function send(address receiver, uint amount) public {
  if (balances[msg.sender] < amount) return;
  balances[msg.sender] -= amount;
  balances[receiver] += amount;
  emit Sent(msg.sender, receiver, amount);
}
```
è¯¥äº‹ä»¶å¯è¿™æ ·è¢«ç›‘å¬:
```solidity
Coin.Sent().watch({}, '', function(error, result) {
    if (!error) {
        console.log("Coin transfer: " + result.args.amount +
            " coins were sent from " + result.args.from +
            " to " + result.args.to + ".");
        console.log("Balances now:\n" +
            "Sender: " + Coin.balances.call(result.args.from) +
            "Receiver: " + Coin.balances.call(result.args.to));
    }
})
```
äº‹ä»¶çš„å‚æ•°å¯ä»¥é€šè¿‡ä¸Šè¿°å›è°ƒå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„å±æ€§`args`è®¿é—®ï¼Œæœ¬ä¾‹ä¸º`result.args`ã€‚
3. å…¨å±€å˜é‡`msg`,`tx`,`block`ä¿å­˜ä¸€äº›åŒºå—é“¾çš„å±æ€§ï¼Œå…¶ä¸­`msg.sender`æ°¸è¿œæŒ‡å‘è®¿é—®å½“å‰å‡½æ•°çš„æ¥æºåœ°å€ï¼ˆåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œ`msg.sender`æŒ‡å‘æ™ºèƒ½åˆçº¦çš„åˆ›å»ºè€…ï¼‰

## åŒºå—é“¾åŸºç¡€
transaction

## gethå®‰è£…
ä¸‹è½½
```bash
wget https://gethstore.blob.core.windows.net/builds/geth-alltools-linux-amd64-1.9.6-bd059680.tar.gz
```
è§£å‹ç¼©
```bash
tar zxvf https://gethstore.blob.core.windows.net/builds/geth-alltools-linux-amd64-1.9.6-bd059680.tar.gz
```
é…ç½®ç¯å¢ƒå˜é‡
1. æ–‡ä»¶å¤¹æ”¹å
2. é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ£€éªŒæ–¹å¼`which geth`æ˜¯å¦è¾“å‡ºgethè·¯å¾„
3. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¿è¯ä¸‹æ¬¡ä»å¯ä»¥æ‰¾åˆ°è¯¥ç¯å¢ƒå˜é‡ï¼Œæ£€éªŒæ–¹å¼å¦‚ä¸Š
```bash
mv geth-alltools-linux-amd64-1.9.6-bd059680 ~/geth-home
export PATH=$HOME/geth-home:$PATH
echo `export PATH=$HOME/geth-home:$PATH` >> ~/.bashrc
```
NOTE:
åŒºå—é“¾å¼€å‘æœ€å¥½ç”¨ç±»unixç³»ç»Ÿï¼Œå¦‚ubuntuã€Macï¼Œå¦åˆ™å¯èƒ½ä¸å¤ªç¨³å®šã€‚å¦‚æœæ˜¯windowsç”µè„‘å¯ä»¥é€‰æ‹©ç”¨è™šæ‹Ÿæœºæˆ–è€…åŒç³»ç»Ÿã€‚

## gethå¯åŠ¨
1.åœ¨gethå¯åŠ¨ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶`genesis.json`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```json
{
  "config": {
        "chainId": 18,
        "homesteadBlock": 0,
        "eip150Block": 0,
        "eip155Block": 0,
        "eip158Block": 0
    },
  "alloc"      : {},
  "coinbase"   : "0x0000000000000000000000000000000000000000",
  "difficulty" : "0x2",
  "extraData"  : "",
  "gasLimit"   : "0xffffffff",
  "nonce"      : "0x0000000000000042",
  "mixhash"    : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "parentHash" : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "timestamp"  : "0x00"
}
```
æ­¥éª¤01ï¼šåˆ©ç”¨åˆ›ä¸–å—æ–‡ä»¶åˆå§‹åŒ–
```cmd
geth init genesis.json --datadir ./data
```
æ­¤æ—¶åœ¨dataæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†ä¸€äº›æ–‡ä»¶
æ­¥éª¤02ï¼šå¯åŠ¨gethèŠ‚ç‚¹
```cmd
geth --datadir ./data --networkid 18 --port 30303 --rpc  --rpcport 8545 --rpcapi 'db,net,eth,web3,personal' --rpccorsdomain "*" --gasprice 0 --allow-insecure-unlock  console 2> 1.log
```

note:
å®˜æ–¹æ•™ç¨‹æ¨èä½¿ç”¨clefå·¥å…·è¿›è¡Œè´¦æˆ·ç®¡ç†ï¼Œå…·ä½“æ­¥éª¤å¯å‚è§


## å‚è€ƒæ•™ç¨‹
[1][æŸé“¾å…¬å¼€è¯¾ï¼šç¬¬äº”æœŸ Gethçš„å®‰è£…](https://www.bilibili.com/video/BV1gK4y1x7BC)
[2][è®²å¸ˆgithubï¼šGethå®‰è£…ä¸å¯åŠ¨](https://github.com/yekai1003/rungeth/blob/master/Geth%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8.md)
[3][Remix IDEå®˜æ–¹æ–‡æ¡£](https://remix-ide.readthedocs.io/en/latest/#)
[4][Solidityå®˜æ–¹æ–‡æ¡£](https://solidity-cn.readthedocs.io/zh/develop/introduction-to-smart-contracts.html)
[5][é“¾é—¨æˆ·ï¼šGethä»‹ç»åŠå¦‚ä½•è¿è¡Œä»¥å¤ªåŠèŠ‚ç‚¹](http://www.lianmenhu.com/blockchain-8217-1)