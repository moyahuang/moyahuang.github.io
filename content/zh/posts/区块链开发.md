---
title: "åŒºå—é“¾å¼€å‘"
date: 2020-12-13T18:06:20+08:00
draft: false
hideToc: false
enableToc: true
enableTocContent: false
author: Moya
authorEmoji: ğŸ“
tags:
- å­¦æœ¯
- åŒºå—é“¾
- æ™ºèƒ½åˆçº¦
libraries:
- katex
---
## Intro
- *Solidity*
> Solidity æ˜¯ä¸€é—¨é¢å‘åˆçº¦çš„ã€ä¸ºå®ç°æ™ºèƒ½åˆçº¦è€Œåˆ›å»ºçš„é«˜çº§ç¼–ç¨‹è¯­è¨€ã€‚è¿™é—¨è¯­è¨€å—åˆ°äº† C++ï¼ŒPython å’Œ Javascript è¯­è¨€çš„å½±å“ï¼Œè®¾è®¡çš„ç›®çš„æ˜¯èƒ½åœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰ä¸Šè¿è¡Œã€‚
- *Remix*
> åŸºäºæµè§ˆå™¨çš„ IDEï¼Œé›†æˆäº†ç¼–è¯‘å™¨å’Œ Solidity è¿è¡Œæ—¶ç¯å¢ƒï¼Œä¸éœ€è¦æœåŠ¡ç«¯ç»„ä»¶ã€‚
- *MetaMask*

> MetaMaskæ˜¯é€šè¿‡æµè§ˆå™¨è®¿é—®åˆ†å¸ƒå¼åº”ç”¨ï¼ˆdappsï¼‰çš„ä¸€ä¸ªChromeæ’ä»¶ã€‚å¯è®¿é—®ä»¥å¤ªåŠä¸»ç½‘ï¼Œä»»ä¸€ä»¥å¤ªåŠæµ‹è¯•ç½‘ï¼ˆRopsten, Kovan, and Rinkebyï¼‰ï¼Œæˆ–è€…æœ¬åœ°åŒºå—é“¾ã€‚

- *Geth*
> Gethæ˜¯Go Ethereumçš„ç¼©å†™ï¼Œæ˜¯ä»¥å¤ªåŠåè®®çš„ä¸‰å¤§åŸå§‹å®ç°ä¹‹ä¸€ï¼ˆå¦å¤–è¿˜æœ‰C++å’ŒPythonï¼‰ï¼Œä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„å®¢æˆ·ç«¯å®ç°ã€‚å®ƒå¯ä»¥ä½œä¸ºå®¢æˆ·ç«¯è¿è¡Œåœ¨å‡ ä¹ä»»ä¸€æ“ä½œç³»ç»Ÿä¸Šã€‚å®‰è£…äº†å®¢æˆ·ç«¯çš„èŠ‚ç‚¹å¯ä»¥ä¸å…¶ä»–èŠ‚ç‚¹å»ºç«‹p2pé€šä¿¡ä¿¡é“ï¼Œç­¾ç½²å’Œå¹¿æ’­äº¤æ˜“ï¼ŒæŒ–æ˜ï¼Œéƒ¨ç½²å’Œä¸æ™ºèƒ½åˆçº¦äº¤äº’ã€‚
> å¯åŠ¨Gethæ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨ç«¯å£8545å¯åŠ¨RPCæœåŠ¡å™¨ã€‚ç„¶åä½¿ç”¨web3jç­‰åº“è¿æ¥åˆ°localhostï¼š8545æˆ–ä½¿ç”¨curlæˆ–wgetæ‰‹åŠ¨è°ƒç”¨å®ƒæ¥è®¿é—®æ­¤ç«¯å£çš„RPCæœåŠ¡å™¨åŠå…¶æ–¹æ³•ã€‚

- *Web3.js*
> web.jsæ˜¯é€šè¿‡HTTP/IPC/WebSocketç­‰åè®®ç”¨äºå’Œæœ¬åœ°æˆ–è¿œç¨‹ä»¥å¤ªåŠèŠ‚ç‚¹è¿›è¡Œäº¤äº’çš„javascriptåº“ã€‚

- [*Quorum*](https://rdc.hundsun.com/portal/article/892.html)

## ç®€å•çš„æ™ºèƒ½åˆçº¦
1. Solidityç¬¬ä¸€è¡Œä½¿ç”¨å…³é”®è¯`pragma`æŒ‡å®šä½¿ç”¨å“ªä¸ªç‰ˆæœ¬ç¼–è¯‘å™¨å¤„ç†æºä»£ç ã€‚
2. `event`äº‹ä»¶ç±»å‹å¯ä»¥è®©ç›‘å¬è¯¥äº‹ä»¶çš„listeneræ”¶åˆ°é€šçŸ¥ï¼Œæ–¹ä¾¿äº‹åŠ¡è¿½è¸ªã€‚
ä¸‹é¢è¿™ä¸ªç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªäº‹ä»¶ï¼Œæ”¾åœ¨éœ€è¦ç›‘å¬çš„å‡½æ•°æœ€åæ‰§è¡Œï¼š
```solidity
event Sent(address from, address to, uint amount);
function send(address receiver, uint amount) public {
  if (balances[msg.sender] < amount) return;
  balances[msg.sender] -= amount;
  balances[receiver] += amount;
  emit Sent(msg.sender, receiver, amount);
}
```
è¯¥äº‹ä»¶å¯è¿™æ ·è¢«ç›‘å¬:
```javascript
Coin.Sent().watch({}, '', function(error, result) {
    if (!error) {
        console.log("Coin transfer: " + result.args.amount +
            " coins were sent from " + result.args.from +
            " to " + result.args.to + ".");
        console.log("Balances now:\n" +
            "Sender: " + Coin.balances.call(result.args.from) +
            "Receiver: " + Coin.balances.call(result.args.to));
    }
})
```
äº‹ä»¶çš„å‚æ•°å¯ä»¥é€šè¿‡ä¸Šè¿°å›è°ƒå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°çš„å±æ€§`args`è®¿é—®ï¼Œæœ¬ä¾‹ä¸º`result.args`ã€‚

{{< notice warning >}}
ç»æµ‹è¯•ï¼Œäº‹ä»¶ç›‘å¬è¦ä¸‹é¢è¿™æ ·å†™æ‰æœ‰æ•ˆï¼Œå¯èƒ½æ˜¯web3ç‰ˆæœ¬çš„é—®é¢˜
{{< /notice >}}
```javascript
MetaCoinContract.events.Sent(function(err, result){
  if(!err){
    ...
  }
})
```
3. å…¨å±€å˜é‡`msg`,`tx`,`block`ä¿å­˜ä¸€äº›åŒºå—é“¾çš„å±æ€§ï¼Œå…¶ä¸­`msg.sender`æ°¸è¿œæŒ‡å‘è®¿é—®å½“å‰å‡½æ•°çš„æ¥æºåœ°å€ï¼ˆåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œ`msg.sender`æŒ‡å‘æ™ºèƒ½åˆçº¦çš„åˆ›å»ºè€…ï¼‰

## åŒºå—é“¾åŸºç¡€
### Â· äº‹åŠ¡/äº¤æ˜“(transaction)
> åŒºå—é“¾æ˜¯å…¨çƒå…±äº«çš„äº‹åŠ¡æ€§æ•°æ®åº“ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªäººéƒ½å¯åŠ å…¥ç½‘ç»œæ¥é˜…è¯»æ•°æ®åº“ä¸­çš„è®°å½•ã€‚å¦‚æœä½ æƒ³æ”¹å˜æ•°æ®åº“ä¸­çš„æŸäº›ä¸œè¥¿ï¼Œä½ å¿…é¡»åˆ›å»ºä¸€ä¸ªè¢«æ‰€æœ‰å…¶ä»–äººæ‰€æ¥å—çš„äº‹åŠ¡ã€‚äº‹åŠ¡ä¸€è¯æ„å‘³ç€ä½ æƒ³åšçš„ï¼ˆå‡è®¾æ‚¨æƒ³è¦åŒæ—¶æ›´æ”¹ä¸¤ä¸ªå€¼ï¼‰ï¼Œè¦ä¹ˆä¸€ç‚¹æ²¡åšï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆã€‚æ­¤å¤–ï¼Œå½“ä½ çš„äº‹åŠ¡è¢«åº”ç”¨åˆ°æ•°æ®åº“æ—¶ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½ä¿®æ”¹æ•°æ®åº“ã€‚
>
> ä¸¾ä¸ªä¾‹å­ï¼Œè®¾æƒ³ä¸€å¼ è¡¨ï¼Œåˆ—å‡ºç”µå­è´§å¸ä¸­æ‰€æœ‰è´¦æˆ·çš„ä½™é¢ã€‚å¦‚æœè¯·æ±‚ä»ä¸€ä¸ªè´¦æˆ·è½¬ç§»åˆ°å¦ä¸€ä¸ªè´¦æˆ·ï¼Œæ•°æ®åº“çš„äº‹åŠ¡ç‰¹æ€§ç¡®ä¿äº†å¦‚æœä»ä¸€ä¸ªè´¦æˆ·æ‰£é™¤é‡‘é¢ï¼Œå®ƒæ€»è¢«æ·»åŠ åˆ°å¦ä¸€ä¸ªè´¦æˆ·ã€‚å¦‚æœç”±äºæŸäº›åŸå› ï¼Œæ— æ³•æ·»åŠ é‡‘é¢åˆ°ç›®æ ‡è´¦æˆ·æ—¶ï¼Œæºè´¦æˆ·ä¹Ÿä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚
>
> æ­¤å¤–ï¼Œäº¤æ˜“æ€»æ˜¯ç”±å‘é€äººï¼ˆåˆ›å»ºè€…ï¼‰ç­¾åã€‚
>
> è¿™æ ·ï¼Œå°±å¯éå¸¸ç®€å•åœ°ä¸ºæ•°æ®åº“çš„ç‰¹å®šä¿®æ”¹å¢åŠ è®¿é—®ä¿æŠ¤æœºåˆ¶ã€‚åœ¨ç”µå­è´§å¸çš„ä¾‹å­ä¸­ï¼Œä¸€ä¸ªç®€å•çš„æ£€æŸ¥å¯ä»¥ç¡®ä¿åªæœ‰æŒæœ‰è´¦æˆ·å¯†é’¥çš„äººæ‰èƒ½ä»ä¸­è½¬è´¦ã€‚

## ä»¥å¤ªåŠè™šæ‹Ÿæœº
### Â· è´¦å·(account)
> ä»¥å¤ªåŠä¸­æœ‰ä¸¤ç±»è´¦æˆ·ï¼ˆå®ƒä»¬å…±ç”¨åŒä¸€ä¸ªåœ°å€ç©ºé—´ï¼‰ï¼š **å¤–éƒ¨è´¦æˆ·**(external accounts) ç”±å…¬é’¥-ç§é’¥å¯¹ï¼ˆä¹Ÿå°±æ˜¯äººï¼‰æ§åˆ¶ï¼› **åˆçº¦è´¦æˆ·**(contract accounts) ç”±å’Œè´¦æˆ·ä¸€èµ·å­˜å‚¨çš„ä»£ç æ§åˆ¶.
> 
> å¤–éƒ¨è´¦æˆ·çš„åœ°å€æ˜¯ç”±å…¬é’¥å†³å®šçš„ï¼Œè€Œåˆçº¦è´¦æˆ·çš„åœ°å€æ˜¯åœ¨åˆ›å»ºè¯¥åˆçº¦æ—¶ç¡®å®šçš„ï¼ˆè¿™ä¸ªåœ°å€é€šè¿‡åˆçº¦åˆ›å»ºè€…çš„åœ°å€å’Œä»è¯¥åœ°å€å‘å‡ºè¿‡çš„äº¤æ˜“æ•°é‡è®¡ç®—å¾—åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œnonceâ€ï¼‰
> 
> æ— è®ºå¸æˆ·æ˜¯å¦å­˜å‚¨ä»£ç ï¼Œè¿™ä¸¤ç±»è´¦æˆ·å¯¹ EVM æ¥è¯´æ˜¯ä¸€æ ·çš„ã€‚
> 
> æ¯ä¸ªè´¦æˆ·éƒ½æœ‰ä¸€ä¸ªé”®å€¼å¯¹å½¢å¼çš„æŒä¹…åŒ–å­˜å‚¨ã€‚å…¶ä¸­ key å’Œ value çš„é•¿åº¦éƒ½æ˜¯256ä½ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º **å­˜å‚¨**(storage) ã€‚
> 
> æ­¤å¤–ï¼Œæ¯ä¸ªè´¦æˆ·æœ‰ä¸€ä¸ªä»¥å¤ªå¸ä½™é¢ï¼ˆ balance ï¼‰ï¼ˆæœ€å°å•ä½æ˜¯$Wei$, $1 ether=10^{18}Wei$ï¼‰ï¼Œä½™é¢ä¼šå› ä¸ºå‘é€åŒ…å«ä»¥å¤ªå¸çš„äº¤æ˜“è€Œæ”¹å˜ã€‚
### Â· äº¤æ˜“(transaction)
> äº¤æ˜“å¯ä»¥çœ‹ä½œæ˜¯ä»ä¸€ä¸ªå¸æˆ·å‘é€åˆ°å¦ä¸€ä¸ªå¸æˆ·çš„æ¶ˆæ¯ï¼ˆè¿™é‡Œçš„è´¦æˆ·ï¼Œå¯èƒ½æ˜¯ç›¸åŒçš„æˆ–ç‰¹æ®Šçš„é›¶å¸æˆ·ï¼Œè¯·å‚é˜…ä¸‹æ–‡ï¼‰ã€‚å®ƒèƒ½åŒ…å«ä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®ï¼ˆåˆçº¦è´Ÿè½½ï¼‰å’Œä»¥å¤ªå¸ã€‚
> 
> å¦‚æœç›®æ ‡è´¦æˆ·å«æœ‰ä»£ç ï¼Œæ­¤ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä»¥ payload ä½œä¸ºå…¥å‚ã€‚
> 
> å¦‚æœç›®æ ‡è´¦æˆ·æ˜¯é›¶è´¦æˆ·ï¼ˆè´¦æˆ·åœ°å€ä¸º 0 )ï¼Œæ­¤äº¤æ˜“å°†åˆ›å»ºä¸€ä¸ª æ–°åˆçº¦ ã€‚ å¦‚å‰æ–‡æ‰€è¿°ï¼Œåˆçº¦çš„åœ°å€ä¸æ˜¯é›¶åœ°å€ï¼Œè€Œæ˜¯é€šè¿‡åˆçº¦åˆ›å»ºè€…çš„åœ°å€å’Œä»è¯¥åœ°å€å‘å‡ºè¿‡çš„äº¤æ˜“æ•°é‡è®¡ç®—å¾—åˆ°çš„ï¼ˆæ‰€è°“çš„â€œnonceâ€ï¼‰ã€‚ **è¿™ä¸ªç”¨æ¥åˆ›å»ºåˆçº¦çš„äº¤æ˜“çš„ payload ä¼šè¢«è½¬æ¢ä¸º EVM å­—èŠ‚ç å¹¶æ‰§è¡Œã€‚æ‰§è¡Œçš„è¾“å‡ºå°†ä½œä¸ºåˆçº¦ä»£ç è¢«æ°¸ä¹…å­˜å‚¨ã€‚è¿™æ„å‘³ç€ï¼Œä¸ºåˆ›å»ºä¸€ä¸ªåˆçº¦ï¼Œä½ ä¸éœ€è¦å‘é€å®é™…çš„åˆçº¦ä»£ç ï¼Œè€Œæ˜¯å‘é€èƒ½å¤Ÿäº§ç”Ÿåˆçº¦ä»£ç çš„ä»£ç ã€‚**

### Â· Gas
> ä¸ºäº†é¿å…ç½‘ç»œæ»¥ç”¨åŠå›é¿ç”±äºå›¾çµå®Œå¤‡è€Œå¸¦æ¥çš„ä¸€äº›ä¸å¯é¿å…çš„é—®é¢˜(the halting problem)ï¼Œåœ¨ä»¥å¤ªåŠä¸­æ‰€æœ‰çš„ç¨‹åºæ‰§è¡Œéƒ½æ”¶è´¹ã€‚Gasæ˜¯åŸºæœ¬çš„å·¥ä½œé‡æˆæœ¬å•ä½ï¼Œç”¨äºè®¡é‡åœ¨ä»¥å¤ªåŠåŒºå—é“¾ä¸Šæ‰§è¡Œæ“ä½œæ‰€éœ€çš„è®¡ç®—ã€å­˜å‚¨èµ„æºå’Œå¸¦å®½ï¼Œå…¶ç›®çš„æ˜¯é™åˆ¶æ‰§è¡Œäº¤æ˜“æ‰€éœ€çš„å·¥ä½œé‡ã€‚å„ç§æ“ä½œçš„è´¹ç”¨ä»¥gasä¸ºå•ä½è®¡ç®—ã€‚ä»»æ„çš„ç¨‹åºç‰‡æ®µï¼ˆåŒ…æ‹¬åˆçº¦åˆ›å»ºã€æ¶ˆæ¯è°ƒç”¨ã€åˆ†é…èµ„æºä»¥åŠè®¿é—®è´¦æˆ·storageã€åœ¨è™šæ‹Ÿæœºä¸Šæ‰§è¡Œæ“ä½œç­‰ï¼‰éƒ½æœ‰ä¸€ä¸ªæ™®éè®¤åŒçš„gasæˆæœ¬ã€‚Gasæœ‰ä¸¤ä¸ªä½œç”¨ï¼š
> 
> - ä»¥å¤ªåŠ(ä¸ç¨³å®šçš„)ä»·æ ¼å’ŒçŸ¿å·¥å·¥ä½œæŠ¥é…¬ä¹‹é—´çš„ç¼“å†²
> - å¯¹æ‹’ç»æœåŠ¡(DoS)æ”»å‡»çš„é˜²å¾¡.
> 
> æ¯ä¸€ä¸ªäº¤æ˜“éƒ½è¦æŒ‡å®šä¸€ä¸ª gas ä¸Šé™ï¼šgasLimitã€‚å‘é€è€…é€šè¿‡åœ¨äº¤æ˜“ä¸­æŒ‡å®šgas priceæ¥è´­ä¹°gasï¼Œç³»ç»Ÿé¢„å…ˆä»å‘é€è€…çš„è´¦æˆ·ä½™é¢ä¸­æ‰£é™¤gasLimit * gasPriceçš„äº¤æ˜“è´¹ï¼Œå³é‡‡ç”¨é¢„ä»˜è´¹æœºåˆ¶ã€‚Gas priceæ˜¯æŒ‡å½“ä½ å°†äº¤æ˜“å‘é€åˆ°ä»¥å¤ªåŠç½‘ç»œæ—¶ï¼Œæ„¿æ„æ”¯ä»˜çš„æ¯å•ä½gasçš„ä»·æ ¼ã€‚å¦‚æœè´¦æˆ·ä½™é¢ä¸è¶³ï¼Œäº¤æ˜“ä¼šè¢«è§†ä¸ºæ— æ•ˆäº¤æ˜“ã€‚ä¹‹æ‰€ä»¥å°†å…¶å‘½åä¸º gasLimitï¼Œæ˜¯å› ä¸ºå‰©ä½™çš„ gasä¼šåœ¨äº¤æ˜“å®Œæˆåè¢«è¿”è¿˜ï¼ˆä¸è´­ä¹°æ—¶åŒæ ·ä»·æ ¼ï¼‰åˆ°å‘é€è€…è´¦æˆ·ã€‚æ¯ä¸ªçŸ¿å·¥è‡ªå·±é€‰æ‹©ä»–ä»¬æƒ³è¦æ¥å—å’Œæ‹’ç»çš„gasä»·æ ¼ã€‚äº¤æ˜“è€…ä»¬åˆ™éœ€è¦åœ¨é™ä½ gas ä»·æ ¼å’Œä½¿äº¤æ˜“èƒ½å°½å¿«è¢«çŸ¿å·¥æ‰“åŒ…é—´è¿›è¡Œæƒè¡¡ã€‚
## gethå®‰è£…
ä¸‹è½½
```bash
wget https://gethstore.blob.core.windows.net/builds/geth-alltools-linux-amd64-1.9.6-bd059680.tar.gz
```
è§£å‹ç¼©
```bash
tar zxvf https://gethstore.blob.core.windows.net/builds/geth-alltools-linux-amd64-1.9.6-bd059680.tar.gz
```
é…ç½®ç¯å¢ƒå˜é‡
1. æ–‡ä»¶å¤¹æ”¹å
2. é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ£€éªŒæ–¹å¼`which geth`æ˜¯å¦è¾“å‡ºgethè·¯å¾„
3. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¿è¯ä¸‹æ¬¡ä»å¯ä»¥æ‰¾åˆ°è¯¥ç¯å¢ƒå˜é‡ï¼Œæ£€éªŒæ–¹å¼å¦‚ä¸Š
```bash
mv geth-alltools-linux-amd64-1.9.6-bd059680 ~/geth-home
export PATH=$HOME/geth-home:$PATH
echo `export PATH=$HOME/geth-home:$PATH` >> ~/.bashrc
```
NOTE:
åŒºå—é“¾å¼€å‘æœ€å¥½ç”¨ç±»unixç³»ç»Ÿï¼Œå¦‚ubuntuã€Macï¼Œå¦åˆ™å¯èƒ½ä¸å¤ªç¨³å®šã€‚å¦‚æœæ˜¯windowsç”µè„‘å¯ä»¥é€‰æ‹©ç”¨è™šæ‹Ÿæœºæˆ–è€…åŒç³»ç»Ÿã€‚

## gethå¯åŠ¨
1.åœ¨gethå¯åŠ¨ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶`genesis.json`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
```json
{
  "config": {
        "chainId": 18,
        "homesteadBlock": 0,
        "eip150Block": 0,
        "eip155Block": 0,
        "eip158Block": 0
    },
  "alloc"      : {},
  "coinbase"   : "0x0000000000000000000000000000000000000000",
  "difficulty" : "0x2",
  "extraData"  : "",
  "gasLimit"   : "0xffffffff",
  "nonce"      : "0x0000000000000042",
  "mixhash"    : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "parentHash" : "0x0000000000000000000000000000000000000000000000000000000000000000",
  "timestamp"  : "0x00"
}
```
æ­¥éª¤01ï¼šåˆ©ç”¨åˆ›ä¸–å—æ–‡ä»¶åˆå§‹åŒ–
```cmd
geth init genesis.json --datadir ./data
```
æ­¤æ—¶åœ¨dataæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†ä¸€äº›æ–‡ä»¶
æ­¥éª¤02ï¼šå¯åŠ¨gethèŠ‚ç‚¹
```cmd
geth --datadir ./data --networkid 18 --port 30303 --rpc  --rpcport 8545 --rpcapi 'db,net,eth,web3,personal' --rpccorsdomain "*" --gasprice 0 --allow-insecure-unlock  console 2> 1.log
```

note:
å®˜æ–¹æ•™ç¨‹æ¨èä½¿ç”¨clefå·¥å…·è¿›è¡Œè´¦æˆ·ç®¡ç†ï¼Œå…·ä½“æ­¥éª¤å¯å‚è§

## ä½¿ç”¨Web3.jsä¸æ™ºèƒ½åˆçº¦äº¤äº’
ä»¥ä¸‹ç¤ºä¾‹`web3.js`ç‰ˆæœ¬ä¸º1.2
ç°åœ¨å‡è®¾ä½ æœ‰ä¸€æ¡è¿è¡Œä¸­çš„åŒºå—é“¾ï¼Œä¸”åœ¨åŒºå—é“¾ä¸Šéƒ¨ç½²äº†ä½ çš„æ™ºèƒ½åˆçº¦ã€‚
æ­¥éª¤1 åˆ›å»ºweb3å®ä¾‹
```javascript 
const Web3=require('web3');
const web3=new Web3(Web3.HttpProvider('http://localhost:7545'));
// å¯ä»¥ç®€å†™ä¸º const web3=new Web3('http://localhost:7545');
```
æ‰€æœ‰ä¸åŒºå—é“¾çš„äº¤äº’éƒ½è¿”å›ä¸€ä¸ªPromsieï¼Œå¯ä»¥ç”¨`await`ç­‰å¾…äº¤äº’è¿”å›çš„ç»“æœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```javascript
async function run(){
  const accounts=await web3.eth.getAccounts()
  console.log(accounts)
  const balance=await web3.eth.getBalance(accounts[0])
  console.log(balance)
}
run();
```
æ­¥éª¤2 è·å–æ™ºèƒ½åˆçº¦å®ä¾‹
è·å–å®ä¾‹éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œåˆçº¦åœ°å€ä»¥åŠåˆçº¦ABI
{{< notice info >}}
ABIæ˜¯æ™ºèƒ½åˆçº¦å¯ä»¥è¢«å¤–éƒ¨è°ƒç”¨çš„JSONç»“æ„ï¼Œå³è¢«`external`å’Œ`public`æ ‡æ³¨çš„å‡½æ•°ã€‚
{{< /notice >}}
```javascript
const MyContract=new web3.eth.Contract(abiJSON, contractAddress)
```

å‰é¢å·²ç»å¯¹Web3.jsè¿›è¡Œäº†ç®€å•çš„ä»‹ç»ï¼Œä¸å†èµ˜è¿°ã€‚ä¸‹é¢æœ‰å‡ ç‚¹éœ€è¦äº†è§£ï¼š
1. Web3.jsçš„ç‰ˆæœ¬æ›´æ–°éå¸¸å¿«ï¼Œä¸”ç‰ˆæœ¬é—´å¾ˆå¯èƒ½ä¸èƒ½å…¼å®¹ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸­çš„ä¾‹å­å¾ˆå¯èƒ½å¾ˆå¿«å°±æ— æ•ˆäº†ã€‚
2. åœ¨ä»¥å¤ªåŠçš„ä¼—å¤šAPIä¸­ï¼Œæœ‰ä¸¤ä¸ªAPIæœ€ä¸ºé‡è¦`eth_sendTransaction`å’Œ`eth_call`ã€‚
ä»€ä¹ˆæ—¶å€™ç”¨`transactions`ï¼Œä»€ä¹ˆæ—¶å€™ç”¨`call`å‘¢ï¼Ÿ

åœ¨Solidityä¸­æœ‰ä¸¤ç§å‡½æ•°
- `view`å‡½æ•°ï¼Œä¸ä¼šä¿®æ”¹çŠ¶æ€å˜é‡çš„å‡½æ•°
- `non-view`å‡½æ•°ï¼Œè¦ä¿®æ”¹çŠ¶æ€å˜é‡çš„å‡½æ•°
ä¸¤ç§å‡½æ•°åˆ†åˆ«å¯¹åº”`call`å’Œ`transactions`ï¼Œå› æ­¤å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š
1. call
```
// js
const result=await myContract.methods.foo(1).call({from: '0x123ABC...'})
// solidity
function foo(uint a) view external returns(bool){
  // ...
  return true;
}
```
2. transaction
```
// js
const result=await myContract.methods.bar(1).send({from: '0x123ABC...'})
// solidity
function bar(uint a) external {
  // ...
  // no return
}
```
## å‚è€ƒæ•™ç¨‹
[1] [æŸé“¾å…¬å¼€è¯¾ï¼šç¬¬äº”æœŸ Gethçš„å®‰è£…](https://www.bilibili.com/video/BV1gK4y1x7BC)
[2] [è®²å¸ˆgithubï¼šGethå®‰è£…ä¸å¯åŠ¨](https://github.com/yekai1003/rungeth/blob/master/Geth%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8.md)
[3] [Remix IDEå®˜æ–¹æ–‡æ¡£](https://remix-ide.readthedocs.io/en/latest/#)
[4] [Solidityå®˜æ–¹æ–‡æ¡£ï¼ˆè¯¥æ–‡æ¡£å¯¹åŒºå—é“¾åŸºç¡€çŸ¥è¯†çš„æè¿°å†™å¾—å¾ˆå¥½ï¼‰](https://solidity-cn.readthedocs.io/zh/develop/introduction-to-smart-contracts.html)
[5] [é“¾é—¨æˆ·ï¼šGethä»‹ç»åŠå¦‚ä½•è¿è¡Œä»¥å¤ªåŠèŠ‚ç‚¹](http://www.lianmenhu.com/blockchain-8217-1)
[6] [web3jså®˜æ–¹æ–‡æ¡£](https://web3js.readthedocs.io/en/v1.3.0/index.html#)
[7] [CSDNï¼šå­¦ä¹ ä»¥å¤ªåŠGasæœºåˆ¶](https://blog.csdn.net/liuqiang55888/article/details/105802752)

